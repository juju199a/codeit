# 3. React 배포하기
## 01. 빌드하기
1. 자바스크립트로 변환
  - html, css, js, video, image
  - JSX로 작성한 코드는 사실 이것은 웹브라우저가 그대로 해석할 수 없는 것이다.
  - 이것을 순수한 `자바스크립트 코드로 변환`한 다음에, 웹서버를 통해서 제공되어야 하는데요.

2. 빌드
  - 브라우저가 해석할 수 있고, 웹서버가 사용하기 좋도록 만드는 과정은
  - 프론트엔드 과정에서는 `빌드`라고 부릅니다.

3. 명령어
  - 동작중인 개발 모드는 멈추고,
  - `npm run build`
  - build 라는 폴더가 생겨난다.

4. 로컬 환경에서 실행
  - `npx serve build`
  - npx 라는 장소에서 serve 라는 프로그램을 다운 받고, 방금 생성한 build라는 폴더에서 서버를 실행하게 됩니다.

5. 종료
  - Ctrl + C

## 02. 명령어 다시 보기
1. 프로젝트 생성하기
  - `npm init react-app .`

2. 개발모드 실행하기
  - `npm start (npm run start)`

3. 실행 중인 서버 종료하기
  - `ctrl + c`

4. 개발된 프로젝트 빌드하기
  - `npm run build`

5. 빌드한 것 로컬에서 실행하기
  - `npx serve build`

## 03. 웹 사이트 배포하기 (AWS S3)
1. AWS
  - `https://aws.amazon.com/ko/
  - AWS 계정 생성

2. AWS S3
  - AWS에서 S3라는 것을 사용해 볼 건데요.
  - 모든 서비스 > 스토리지 > S3 
  - S3는 구글 드라이브와 같은 `저장소`이다.
  - 12개월 뒤에는 사용한 만큼 비용을 낸다.

3. 버킷
  - 버킷을 만들 건데요. 
  - `버킷`은 컴퓨터의 C드라이브 D드라이브로 드라이브를 나누듯이
  - S3에서 파일을 모아두는 큰 단위라고 생각하시면 됩니다.
  - `버킷 만들기`
  - 버킷 이름: `juju199a.dicegame.react.codeit`
    - 만약에 커스텀 도메인을 적용할 것이라면, 버킷이름도 동일하게 작성해야 한다.
  - `모든 퍼블릭 액세스 차단` > 체크박스 해제 / 알고있습니다 > 체크
  - `버킷 만들기`

4. 버킷 추가 설정 > 속성
  - `juju199a.dicegame.react.codeit` 클릭
  - `속성` > (제일 아래) 정적 웹 사이트 호스팅 > 편집 > `활성화` 
  - 인덱스 문서: index.html
  - 오류 문서: index.html
    - 오류 문서는 파일이 없는 경로로 접속 하는 경우 보여줄 html 파일인데요.
    - 이렇게 index.html로 지정해 주면, 경로처리를 `리액트`로 할 수 있다는 장점이 있습니다.
  - `변경사항 저장`

5. 버킷 추가 설정 > 권한
  - `권한` > 버킷 정책 > 편집 > 정책 생성기
    - 웹 브라우저가 버킷에서 할 수 있는 권한을 설정해 주는 것인데요.
    - 모두에게 공개된 인터넷 배포할 것이기 때문에 
    - `모든 사용자 들이 S3 파일을 읽을 수 있도록` 권한 설정을 해 줄 것이다.
  - `Step 1: Select Policy Type`
    - 스탭 1에서 우리가 만들 것은 S3의 버킷 정책이니까, `S3 Bucket Policy`를 선택해 준다.
  - `Step 1: Add Statement(s)`
    - Principal : `* 입력`
    - *는 이 정책을 모든 사용자에게 적용할 것이다는 의미입니다.
    - AWS Service: Amazon S3
    - Actions: `GetObject 선택`
    - Amazon Resource Name (ARN) > 버킷 ARN 복사 > 붙여 넣기 > `/*` 뒤에 붙이기
    - `버킷에 있는 모든 파일에 이 정책을 적용한다` 라는 의미
    - Add Statement > Generate Policy > `JSON 문자열`로 정책이 만들어진다.
    - JSON 복사 > `정책`부분에 붙여 넣기 > `변경 사항 저장` 클릭
    - 버킷 생성과 배포에 필요한 모든 부분이 끝났다.

6. 빌드파일 업로드
  - `객체` 메뉴로 돌아가기
  - `업로드` 버튼 
  - build 폴더 안의 파일을 끌어다 넣는다.
  - `업로드` 클릭합니다.
  - 업로드가 완료 되면, `닫기`를 누른다.

7. 접속
  - `속성` 메뉴에서 `맨 아래`
  - 버킷 웹 사이트 엔드포인트
  - s3 버킷 주소라는 것을 알 수 있습니다.

## 04. (옵션) 커스텀 도메인 달기 (AWS Route53)
1. AWS에서 도메인 구입하기
  - 검색 > Route53
  - 도메인 > 등록된 도메인
  - `codeit` 도메인 검색
  - `react.pizza` 구입
  - 도메인 이름 클릭

2. 다른 사이트에서 도메인을 구입한 경우
  - Route 53 > 호스트 영역
  - `react.pizza`
  - `NS: 커스텀 네임 서버`
  - AWS 호스팅 영역에서 기본 값으로 생성된 레코드 중에서 `NS유형`에 해당하는 `값/트래픽 라우팅 대상`의 값을 복사해서 커스텀 네임 서버로 등록해 줍니다.
  - `https://dnschecker.org`로 들어가서 확인

3. A 레코드 등록하기
  - Route 53의 호스팅 영역에 A 레코드를 등록해 볼 겁니다.
  - A 레코드는 웹 브라우저가 `react.pizza`라는 도메인 주소로 들어왔을 때, 어떤 주소의 서버가 응답해 줄지 지정해 주는 용도로 씁니다.
  - 우리의 경우 도메인 주소로 들어오면,AWS S3 버킷의 웹 사이트의 엔드포인드가 응답해 주면 되겠죠.
  - 호스팅 영역 > `레코드 생성`
  - `dicegame.react.pizza` 
  - 서브 도메인으로 만드셔도 좋고, 
  - 레코드 이름을 그냥 비워두면 `react.pizza`처럼 최상위 주소로 A 레코드를 생성할 수 있습니다.
  - `레코드 유형 A`
  - 트래픽 라우팅 대상에서 `별칭`
  - 별칭은 AWS에서 제공하는 기능인데요.
  - 우리가 만들어 놓은 S3 버킷의 엔드포인트(주소)를 직접 입력하지 않아도 되고,
  - AWS 안에서 별명처럼 쓸 수 있게 해 줍니다.
  - **중요** 만약에 `react.pizza`라는 주소로 만들고 싶다면
  - 버킷 이름도 반드시 `react.pizza`로 해줘야 한다는 것에 주의하세요.
  - `레코드 생성` > A 레코드 생성 완료
  - `https:dnschecker.org`에서 A레코드 선택해서 확인

## 05. 브라우저는 어떻게 리액트를 알아들을까?
1. 
  - 우리가 배포한 리액트 코드가 어떻게 실행되는지 알아 볼텐데요.

2. 버튼 컴포넌트 파일
  - 웹 브라우저 에서는 JSX 문법을 사용할 수가 없다.
  - JSX는 순수한 자바스크립트로 번역해서 실행되어야 하는데요.
  - Babeljs.io 사이트로 들어 오면, `Babel이라는 프로그램`을 통해서 JSX가 어떻게 순수 자바스크립트로 변역되는지 확인할 수 있습니다.
  - Babel은 JSX를 JS로 변역하는 프로그램 중에서 가장 대표적인 프로그램인데요.

3. Try it out
  - Babel을 테스트 해 볼 수 있는 페이지가 나온다.

4. `트랜스파일형`
  - 트랜스 파일러 
  - Babel은 대표적인 트랜트 파일러

5. 번들링
  - build 에서 소스 구조가 다르다.
  - static, js
  - 소스코드들의 파일들을 압축해서 묶어 놓은 파일이다.
  - 파일을 압축해서 묶으면, 용량을 줄일 수 있고, 웹브라우저가 훨씬 더 빨리 다운로드 받을 수 있게 됩니다.
  - `이러한 묶음 파일을 번들`이라고 부릅니다.
  - 자바스크립트 파일들을 하나로 묶어서 만든 것이다.
  - build를 하면 번들링을 알아서 해 준다.

6. 정리
  - 이번 시간에는 `트랜스파일링`과 `번들링`을 통해, 브라우저가 리액트를 알아듣는 원리에 대해서 살펴봤는데요.
  - JSX로 작성된 파일들은 `트랜스파일링`을 통해서 순수 자바스크립트로 번역되고, 
  - 번역된 코드들은 `번들링`을 통해 웹브라우저가 다운로드 받기 좋도록 `묶음`으로 만들어 줍니다.
  - 결과적으로 `리액트 코드`는 `트랜스파일링`과 `번들링`을 통해 웹브라우저가 알아들을 수 있는 자바스크립트 파일로 변환되어야 실행할 수 있다는 점
  
